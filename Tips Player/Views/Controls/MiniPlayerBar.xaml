<?xml version="1.0" encoding="utf-8" ?>
<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodels="clr-namespace:Tips_Player.ViewModels"
             xmlns:helpers="clr-namespace:Tips_Player.Helpers"
             x:Class="Tips_Player.Views.Controls.MiniPlayerBar"
             x:DataType="viewmodels:PlayerViewModel"
             IsVisible="{Binding CurrentMedia, Converter={StaticResource IsNotNullConverter}, FallbackValue=False}">

    <Border Background="#CC1A1A1D"
            Stroke="#33FAFAFA"
            StrokeThickness="1"
            Padding="12"
            StrokeShape="RoundRectangle 0">
        <Border.Shadow>
            <Shadow Brush="Black" Offset="0,-4" Radius="20" Opacity="0.3"/>
        </Border.Shadow>

        <Border.GestureRecognizers>
            <TapGestureRecognizer Tapped="OnMiniPlayerTapped"/>
        </Border.GestureRecognizers>

        <Grid ColumnDefinitions="50,*,Auto,Auto" ColumnSpacing="12">

            <!-- Album Art / Media Icon -->
            <Border Grid.Column="0"
                   Background="{StaticResource SurfaceBackground}"
                   StrokeShape="RoundRectangle 6"
                   Stroke="Transparent"
                   Padding="0"
                   HeightRequest="50"
                   WidthRequest="50">
                <Label Text="{Binding CurrentMedia.MediaType, Converter={StaticResource MediaTypeToIconConverter}}"
                       FontFamily="FontAwesome"
                       FontSize="24"
                       HorizontalOptions="Center"
                       VerticalOptions="Center"/>
            </Border>

            <!-- Track Info -->
            <VerticalStackLayout Grid.Column="1"
                                 VerticalOptions="Center"
                                 Spacing="2">
                <Label Text="{Binding CurrentMedia.Title}"
                       TextColor="{StaticResource TextPrimary}"
                       FontSize="14"
                       FontAttributes="Bold"
                       LineBreakMode="TailTruncation"
                       MaxLines="1"/>
                <Label Text="{Binding CurrentMedia.DisplaySubtitle}"
                       TextColor="{StaticResource TextSecondary}"
                       FontSize="12"
                       LineBreakMode="TailTruncation"
                       MaxLines="1"/>
            </VerticalStackLayout>

            <!-- Play/Pause Button -->
            <Button Grid.Column="2"
                    Text="{Binding IsPlaying, Converter={StaticResource BoolToPlayPauseConverter}}"
                    FontFamily="FontAwesome"
                    Command="{Binding PlayPauseCommand}"
                    BackgroundColor="Transparent"
                    TextColor="{StaticResource TextPrimary}"
                    FontSize="24"
                    HeightRequest="44"
                    WidthRequest="44"
                    CornerRadius="22"
                    Padding="0"/>

            <!-- Next Button -->
            <Button Grid.Column="3"
                    Text="{x:Static helpers:FontIcons.StepForward}"
                    FontFamily="FontAwesome"
                    Command="{Binding NextCommand}"
                    BackgroundColor="Transparent"
                    TextColor="{StaticResource TextSecondary}"
                    FontSize="20"
                    HeightRequest="44"
                    WidthRequest="44"
                    CornerRadius="22"
                    Padding="0"/>

        </Grid>

    </Border>

</ContentView>
